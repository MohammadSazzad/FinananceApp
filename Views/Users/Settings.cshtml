@model FinanceApp.Models.User
@{
    ViewData["Title"] = "Account Settings - " + Model.Username;
}

<div class="settings-header bg-gradient-primary text-white py-4 mb-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <div class="d-flex align-items-center">
                    <div class="settings-icon me-3">
                        <i class="fas fa-cog fa-3x text-warning"></i>
                    </div>
                    <div>
                        <h1 class="display-5 fw-bold mb-2">Account Settings</h1>
                        <p class="lead mb-0">Manage your profile and account preferences</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 text-end">
                <a asp-controller="Users" asp-action="Profile" class="btn btn-outline-light btn-lg">
                    <i class="fas fa-arrow-left me-2"></i>Back to Profile
                </a>
            </div>
        </div>
    </div>
</div>

<div class="container mb-5">
    <!-- Success/Error Messages -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="fas fa-check-circle me-2"></i>@TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-circle me-2"></i>@TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <div class="row">
        <!-- Settings Navigation -->
        <div class="col-lg-3 mb-4">
            <div class="settings-nav card border-0 shadow-sm">
                <div class="card-header bg-white py-3">
                    <h5 class="mb-0 fw-bold text-dark">
                        <i class="fas fa-list me-2 text-primary"></i>Settings Menu
                    </h5>
                </div>
                <div class="card-body p-0">
                    <div class="nav nav-pills flex-column" id="settings-nav" role="tablist">
                        <button class="nav-link active text-start py-3 px-4" id="profile-tab" data-bs-toggle="pill" data-bs-target="#profile-content" type="button" role="tab">
                            <i class="fas fa-user me-3 text-primary"></i>Profile Information
                        </button>
                        <button class="nav-link text-start py-3 px-4" id="security-tab" data-bs-toggle="pill" data-bs-target="#security-content" type="button" role="tab">
                            <i class="fas fa-shield-alt me-3 text-success"></i>Security & Password
                        </button>
                        <button class="nav-link text-start py-3 px-4" id="preferences-tab" data-bs-toggle="pill" data-bs-target="#preferences-content" type="button" role="tab">
                            <i class="fas fa-sliders-h me-3 text-info"></i>Preferences
                        </button>
                        <button class="nav-link text-start py-3 px-4" id="account-tab" data-bs-toggle="pill" data-bs-target="#account-content" type="button" role="tab">
                            <i class="fas fa-user-cog me-3 text-warning"></i>Account Management
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Content -->
        <div class="col-lg-9">
            <div class="tab-content" id="settings-content">
                
                <!-- Profile Information Tab -->
                <div class="tab-pane fade show active" id="profile-content" role="tabpanel">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white py-3">
                            <h4 class="mb-0 fw-bold text-dark">
                                <i class="fas fa-user me-2 text-primary"></i>Profile Information
                            </h4>
                            <small class="text-muted">Update your personal information and contact details</small>
                        </div>
                        <div class="card-body p-4">
                            <form asp-controller="Users" asp-action="UpdateProfile" method="post">
                                <input type="hidden" asp-for="Id" />
                                <input type="hidden" asp-for="CreatedAt" />
                                <input type="hidden" asp-for="Role" />
                                
                                <div class="row g-4">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control" id="username" asp-for="Username" placeholder="Username">
                                            <label for="username">
                                                <i class="fas fa-user me-2"></i>Username
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="email" class="form-control" id="email" asp-for="Email" placeholder="Email">
                                            <label for="email">
                                                <i class="fas fa-envelope me-2"></i>Email Address
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control" id="role" value="@Model.Role" readonly placeholder="Role">
                                            <label for="role">
                                                <i class="fas fa-tag me-2"></i>Account Role
                                            </label>
                                        </div>
                                        <small class="text-muted">Account role cannot be changed</small>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control" id="memberSince" value="@Model.CreatedAt.ToString("MMMM dd, yyyy")" readonly placeholder="Member Since">
                                            <label for="memberSince">
                                                <i class="fas fa-calendar me-2"></i>Member Since
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-end mt-4">
                                    <button type="submit" class="btn btn-primary btn-lg px-4">
                                        <i class="fas fa-save me-2"></i>Update Profile
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Security & Password Tab -->
                <div class="tab-pane fade" id="security-content" role="tabpanel">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white py-3">
                            <h4 class="mb-0 fw-bold text-dark">
                                <i class="fas fa-shield-alt me-2 text-success"></i>Security & Password
                            </h4>
                            <small class="text-muted">Manage your password and security settings</small>
                        </div>
                        <div class="card-body p-4">
                            <form asp-controller="Users" asp-action="ChangePassword" method="post">
                                <div class="row g-4">
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <input type="password" class="form-control" id="currentPassword" name="currentPassword" placeholder="Current Password" required>
                                            <label for="currentPassword">
                                                <i class="fas fa-lock me-2"></i>Current Password
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="password" class="form-control" id="newPassword" name="newPassword" placeholder="New Password" required>
                                            <label for="newPassword">
                                                <i class="fas fa-key me-2"></i>New Password
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" placeholder="Confirm Password" required>
                                            <label for="confirmPassword">
                                                <i class="fas fa-check-circle me-2"></i>Confirm Password
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="password-requirements mt-3 p-3 bg-light rounded">
                                    <h6 class="fw-bold text-dark mb-2">Password Requirements:</h6>
                                    <ul class="list-unstyled mb-0 small text-muted">
                                        <li><i class="fas fa-check text-success me-2"></i>At least 8 characters long</li>
                                        <li><i class="fas fa-check text-success me-2"></i>Contains uppercase and lowercase letters</li>
                                        <li><i class="fas fa-check text-success me-2"></i>Contains at least one number</li>
                                        <li><i class="fas fa-check text-success me-2"></i>Contains at least one special character</li>
                                    </ul>
                                </div>
                                
                                <div class="d-flex justify-content-end mt-4">
                                    <button type="submit" class="btn btn-success btn-lg px-4">
                                        <i class="fas fa-shield-alt me-2"></i>Change Password
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Preferences Tab -->
                <div class="tab-pane fade" id="preferences-content" role="tabpanel">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white py-3">
                            <h4 class="mb-0 fw-bold text-dark">
                                <i class="fas fa-sliders-h me-2 text-info"></i>Preferences
                            </h4>
                            <small class="text-muted">Customize your experience and notifications</small>
                        </div>
                        <div class="card-body p-4">
                            <div class="row g-4">
                                <div class="col-12">
                                    <h5 class="fw-bold text-dark mb-3">
                                        <i class="fas fa-bell me-2"></i>Notification Settings
                                    </h5>
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="emailNotifications" checked>
                                        <label class="form-check-label fw-semibold" for="emailNotifications">
                                            Email Notifications
                                        </label>
                                        <small class="d-block text-muted">Receive email updates about your expenses and account activity</small>
                                    </div>
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="expenseReminders" checked>
                                        <label class="form-check-label fw-semibold" for="expenseReminders">
                                            Expense Reminders
                                        </label>
                                        <small class="d-block text-muted">Get reminded to log your daily expenses</small>
                                    </div>
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="monthlyReports">
                                        <label class="form-check-label fw-semibold" for="monthlyReports">
                                            Monthly Reports
                                        </label>
                                        <small class="d-block text-muted">Receive monthly expense summary reports</small>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <h5 class="fw-bold text-dark mb-3">
                                        <i class="fas fa-palette me-2"></i>Display Preferences
                                    </h5>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">Currency Format</label>
                                            <select class="form-select">
                                                <option selected>USD ($)</option>
                                                <option>BDT (৳)</option>
                                                <option>EUR (€)</option>
                                                <option>GBP (£)</option>
                                                <option>JPY (¥)</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">Date Format</label>
                                            <select class="form-select">
                                                <option selected>MM/DD/YYYY</option>
                                                <option>DD/MM/YYYY</option>
                                                <option>YYYY-MM-DD</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-flex justify-content-end mt-4">
                                <button type="button" class="btn btn-info btn-lg px-4">
                                    <i class="fas fa-save me-2"></i>Save Preferences
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="account-content" role="tabpanel">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white py-3">
                            <h4 class="mb-0 fw-bold text-dark">
                                <i class="fas fa-user-cog me-2 text-warning"></i>Account Management
                            </h4>
                            <small class="text-muted">Manage your account status and data</small>
                        </div>
                        <div class="card-body p-4">
                            <div class="row g-4">
                                <div class="col-12">
                                    <div class="account-info-card p-4 bg-light rounded">
                                        <div class="d-flex align-items-center mb-3">
                                            <i class="fas fa-info-circle fa-2x text-primary me-3"></i>
                                            <div>
                                                <h5 class="fw-bold text-dark mb-1">Account Information</h5>
                                                <p class="text-muted mb-0">View your account details and statistics</p>
                                            </div>
                                        </div>
                                        <div class="row text-center">
                                            <div class="col-md-3">
                                                <div class="stat-item">
                                                    <h4 class="fw-bold text-success">Active</h4>
                                                    <small class="text-muted">Status</small>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="stat-item">
                                                    <h4 class="fw-bold text-info">@((DateTime.Now - Model.CreatedAt).Days)</h4>
                                                    <small class="text-muted">Days Active</small>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="stat-item">
                                                    <h4 class="fw-bold text-warning">@Model.Role</h4>
                                                    <small class="text-muted">Role</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <h5 class="fw-bold text-dark mb-3">
                                        <i class="fas fa-download me-2"></i>Data Export
                                    </h5>
                                    <p class="text-muted">Download your account data and expense history</p>
                                    <button type="button" class="btn btn-outline-primary me-2" onclick="alert('Export feature coming soon!')">
                                        <i class="fas fa-file-csv me-2"></i>Export as CSV
                                    </button>
                                    <button type="button" class="btn btn-outline-primary" onclick="alert('Export feature coming soon!')">
                                        <i class="fas fa-file-pdf me-2"></i>Export as PDF
                                    </button>
                                </div>
                                <div class="col-12">
                                    <div class="danger-zone mt-5 p-4 border border-danger rounded">
                                        <h5 class="fw-bold text-danger mb-3">
                                            <i class="fas fa-exclamation-triangle me-2"></i>Danger Zone
                                        </h5>
                                        <p class="text-muted mb-3">These actions cannot be undone. Please proceed with caution.</p>
                                        <button type="button" class="btn btn-outline-danger" onclick="alert('Account deletion feature will be implemented with proper confirmation dialogs.')">
                                            <i class="fas fa-trash-alt me-2"></i>Delete Account
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.settings-header {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

.settings-nav .nav-link {
    border-radius: 0;
    border: none;
    color: #6c757d;
    font-weight: 500;
    transition: all 0.3s ease;
}

.settings-nav .nav-link:hover {
    background: rgba(74, 172, 254, 0.1);
    color: #4facfe;
    transform: translateX(5px);
}

.settings-nav .nav-link.active {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: white;
    transform: translateX(5px);
    box-shadow: 0 2px 10px rgba(74, 172, 254, 0.3);
}

.form-floating > label {
    font-weight: 500;
}

.password-requirements {
    border-left: 4px solid #28a745;
}

.account-info-card {
    background: linear-gradient(135deg, rgba(74, 172, 254, 0.05) 0%, rgba(0, 242, 254, 0.05) 100%);
    border: 1px solid rgba(74, 172, 254, 0.1);
}

.stat-item h4 {
    margin-bottom: 0.5rem;
}

.danger-zone {
    background: rgba(220, 53, 69, 0.05);
}

@@media (max-width: 767.98px) {
    .settings-nav .nav-link {
        text-align: center !important;
    }
    
    .settings-nav .nav-link:hover,
    .settings-nav .nav-link.active {
        transform: none;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const passwordForm = document.querySelector('form[action*="ChangePassword"]');
    if (passwordForm) {
        passwordForm.addEventListener('submit', function(e) {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (newPassword !== confirmPassword) {
                e.preventDefault();
                alert('New password and confirmation password do not match.');
                return false;
            }
            
            if (newPassword.length < 8) {
                e.preventDefault();
                alert('Password must be at least 8 characters long.');
                return false;
            }
        });
    }
    
    document.querySelector('.btn-info[type="button"]')?.addEventListener('click', function() {
        alert('Preferences saved successfully!');
    });
});
</script>
